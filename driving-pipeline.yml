flow: AutoDrivingPipeline
operators:
  # - id : DetectionOperator
  #   uri: file://./pylot/perception/detection/detection_operator.py
  #   configuration:
  #     obstacle_detection_gpu_index: 0
  #     model_path: ./dependencies/models/obstacle_detection/faster-rcnn/
  #     path_coco_labels: ./dependencies/models/pylot.names
  #     obstacle_detection_min_score_threshold: 3
  #     log_detector_output: true
  #     out_path: ./out_data/
  #   inputs:
  #     - id: FrameMsg
  #       type: usize
  #   outputs:
  #     - id: ObstaclesMsg
  #       type: usize
  # - id : TrafficLightDetOperator
  #   uri: file://./pylot/perception/detection/traffic_light_det_operator.py
  #   configuration:
  #     traffic_light_det_gpu_index: 0
  #     model_path: ./dependencies/models/traffic_light_detection/faster-rcnn/
  #     traffic_light_det_min_score_threshold: 3
  #     log_traffic_light_detector_output: true
  #     out_path: ./out_data/
  #   inputs:
  #     - id: FrameMsg
  #       type: usize
  #   outputs:
  #     - id: TrafficLightsMsg
  #       type: usize
  # - id: LocalizationOperator
  #   uri: file://./pylot/localization/localization_operator.py
  #   inputs:
  #     - id: localizationMsg
  #       type: usize
  #   outputs:
  #     - id: PoseMessage
  #       type: usize
  - id: ObstacleLocationFinderOperator
    uri: file://./pylot/perception/detection/obstacle_location_finder_operator.py
    inputs:
      - id: ObstaclesMsg
        type: usize
    outputs:
      - id: ObstaclesWithLocationMsg
        type: usize
sources:
  # - id : DetectionSrc
  #   uri: file://./sources/detection_source.py
  #   configuration:
  #     image_path: ./data/perfect-detector-6901.png
  #   output:
  #       id: FrameMsg
  #       type: usize
  # - id:  TrafficLightSrc
  #   uri: file://./sources/traffic_light_det_source.py
  #   configuration:
  #     image_path: ./data/center-8711.png
  #   output:
  #       id: FrameMsg
  #       type: usize
  # - id: localizationSrc
  #   uri: file://./sources/localization_source.py
  #   configuration:
  #     gnss_path: ./test_data/LocalizationOperator/input/gnss/gnss-5643.pkl
  #     imu_path: ./test_data/LocalizationOperator/input/imu/imu-5643.pkl
  #     pose_path: ./test_data/LocalizationOperator/input/pose/pose-5643.pkl
  #   output:
  #     id: localizationMsg
  #     type: usize
  - id: ObstacleLocationFinderSrc
    uri: file://./sources/obstacle_location_finder_source.py
    configuration:
      image_path: ./data/center-8711.png
      depth_msg: ./test_data/ObstacleLocationFinderOperator/input/depth_msg-5734.pkl
      obstacles_msg: ./test_data/ObstacleLocationFinderOperator/input/obstacles_msg-5734.pkl
      vehicle_transform: ./test_data/ObstacleLocationFinderOperator/input/vehicle_transform-5734.pkl
    output:
      id: ObstaclesMsg
      type: usize
sinks:
  # - id : DetectionSink
  #   uri: file://./sinks/detection_sink.py
  #   input:
  #       id: ObstaclesMsg
  #       type: usize
  # - id : TrafficLightSink
  #   uri: file://./sinks/traffic_light_det_sink.py
  #   input:
  #       id: TrafficLightsMsg
  #       type: usize
  # - id : LocalizationSink
  #   uri: file://./sinks/localization_sink.py
  #   input:
  #       id: PoseMessage
  #       type: usize
  - id : ObstacleLocationFinderSink
    uri: file://./sinks/obstacle_location_finder_sink.py
    input:
        id: ObstaclesWithLocationMsg
        type: usize
links:
# - from:
#     node : localizationSrc
#     output : localizationMsg
#   to:
#     node : LocalizationOperator
#     input : localizationMsg
# - from:
#     node : LocalizationOperator
#     output : PoseMessage
#   to:
#     node : LocalizationSink
#     input : PoseMessage

# - from:
#     node : DetectionSrc
#     output : FrameMsg
#   to:
#     node : DetectionOperator
#     input : FrameMsg
# - from:
#     node : DetectionOperator
#     output : ObstaclesMsg
#   to:
#     node : DetectionSink
#     input : ObstaclesMsg

# - from:
#     node : TrafficLightSrc
#     output : FrameMsg
#   to:
#     node : TrafficLightDetOperator
#     input : FrameMsg
# - from:
#     node : TrafficLightDetOperator
#     output : TrafficLightsMsg
#   to:
#     node : TrafficLightSink
#     input : TrafficLightsMsg

- from:
    node : ObstacleLocationFinderSrc
    output : ObstaclesMsg
  to:
    node : ObstacleLocationFinderOperator
    input : ObstaclesMsg
- from:
    node : ObstacleLocationFinderOperator
    output : ObstaclesWithLocationMsg
  to:
    node : ObstacleLocationFinderSink
    input : ObstaclesWithLocationMsg

