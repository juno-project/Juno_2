flow: AutoDrivingPipeline
operators:
  - id : DetectionOperator
    uri: file://./pylot/perception/detection/detection_operator.py
    configuration:
      obstacle_detection_gpu_index: 0
      model_path: ./dependencies/models/obstacle_detection/faster-rcnn/
      path_coco_labels: ./dependencies/models/pylot.names
      obstacle_detection_min_score_threshold: 3
      log_detector_output: true
      out_path: ./out_data/
    inputs:
      - id: FrameMsg
        type: usize
    outputs:
      - id: ObstaclesMsg
        type: usize
  - id : TrafficLightDetOperator
    uri: file://./pylot/perception/detection/traffic_light_det_operator.py
    configuration:
      traffic_light_det_gpu_index: 0
      model_path: ./dependencies/models/traffic_light_detection/faster-rcnn/
      traffic_light_det_min_score_threshold: 3
      log_traffic_light_detector_output: true
      out_path: ./out_data/
    inputs:
      - id: FrameMsg
        type: usize
    outputs:
      - id: TrafficLightsMsg
        type: usize
sources:
  - id : DetectionSrc
    uri: file://./sources/detection_source.py
    configuration:
      image_path: ./data/perfect-detector-6901.png
    output:
        id: FrameMsg
        type: usize
  - id:  TrafficLightSrc
    uri: file://./sources/traffic_light_det_source.py
    configuration:
      image_path: ./data/center-8711.png
    output:
        id: FrameMsg
        type: usize
sinks:
  - id : DetectionSink
    uri: file://./sinks/detection_sink.py
    input:
        id: ObstaclesMsg
        type: usize
  - id : TrafficLightSink
    uri: file://./sinks/traffic_light_det_sink.py
    input:
        id: TrafficLightsMsg
        type: usize
links:
- from:
    node : DetectionSrc
    output : FrameMsg
  to:
    node : DetectionOperator
    input : FrameMsg
- from:
    node : DetectionOperator
    output : ObstaclesMsg
  to:
    node : DetectionSink
    input : ObstaclesMsg

- from:
    node : TrafficLightSrc
    output : FrameMsg
  to:
    node : TrafficLightDetOperator
    input : FrameMsg
- from:
    node : TrafficLightDetOperator
    output : TrafficLightsMsg
  to:
    node : TrafficLightSink
    input : TrafficLightsMsg

